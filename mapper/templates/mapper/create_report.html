{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
<h2>Create a New Report</h2>
<form method="post" enctype="multipart/form-data" id="report-form">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const classificationField = document.querySelectorAll('input[name="classification"]');
        const reasonsField = document.querySelector('.form-group:has([name="reasons"])');

        function toggleReasonsField() {
            const selectedValue = document.querySelector('input[name="classification"]:checked').value;
            if (selectedValue === 'red' || selectedValue === 'orange') {
                reasonsField.style.display = '';
            } else {
                reasonsField.style.display = 'none';
                // Uncheck all reasons if hidden
                document.querySelectorAll('input[name="reasons"]').forEach(checkbox => checkbox.checked = false);
            }
        }

        // Attach event listeners to classification radio buttons
        classificationField.forEach(radio => {
            radio.addEventListener('change', toggleReasonsField);
        });

        // Initialize the reasons field visibility
        toggleReasonsField();
    });
</script>
{% endblock %}